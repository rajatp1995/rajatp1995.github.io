
<script src="https://www.gstatic.com/firebasejs/4.9.0/firebase.js"></script>
<script src="https://www.gstatic.com/firebasejs/4.9.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/4.9.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/4.9.0/firebase-database.js"></script>

<html>
<head>
      <link rel="stylesheet" type="text/css" href="normalize.css" />
    <link rel="stylesheet" type="text/css" href="font-awesome.min.css" />
    <link rel="stylesheet" type="text/css" href="set2.css" />
  <title>Smart Shopping Cart</title>
  <script type="text/javascript">
  var config = {
    apiKey: "AIzaSyCn_P-dbq07eDimEGzS8qMGObW1JP_U4ts",
    authDomain: "projectdatabase-d5dcc.firebaseapp.com",
    databaseURL: "https://projectdatabase-d5dcc.firebaseio.com",
    projectId: "projectdatabase-d5dcc",
    storageBucket: "projectdatabase-d5dcc.appspot.com",
    messagingSenderId: "289821114496"
  };
    firebase.initializeApp(config);
 </script>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

  <style>

button {
    background-color: blue;
    border: none;
    color: white;
    padding: 10px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    font-size: 14px;
    margin: 4px 2px;
}
       table, td {
       border: 1px solid black;
       }

       .bluetext {
        color: blue;
       }

       .redtext {
        color: red;
       }
    .containerr{
        width: 100%;
        margin: 0 auto; /* Center the DIV horizontally */
    }
    .fixed-header{
        width: 100%;     
        background: black;
        padding: 12px 0;
        color: #fff;
    }
        .fixed-footer{
        width: 100%; 
        background: black;
        padding: 8px 0;
        color: #fff;
    }
    .fixed-header{
        top: 0;
    }
    .fixed-footer{
        bottom: 0;
    }  


    .sidenav {
    height: 100%;
    width: 0;
    position: fixed;
    z-index: 1;
    top: 0;
    left: 0;
    background-color: #111;
    overflow-x: hidden;
    transition: 0.7s;
    padding-top: 60px;
}

.sidenav a {
    padding: 8px 8px 8px 32px;
    text-decoration: none;
    font-size: 21px;
    color: #818181;
    display: block;
    transition: 0.3s;
}

.sidenav a:hover {
    color: #f1f1f1;
}

.sidenav .closebtn {
    position: absolute;
    top: 0;
    right: 25px;
    font-size: 36px;
    margin-left: 50px;
}

#main {
    transition: margin-left .5s;
    padding: 2px;
}

@media screen and (max-height: 450px) {
  .sidenav {padding-top: 15px;}
  .sidenav a {font-size: 18px;}
}

body {
    font-family: "Lato", sans-serif;
    transition: background-color .5s;
}
  </style>

</head>
<body>
  <div id="main">
  <div class="fixed-header">
  <div class="containerr"><h4><center><u>Smart Shopping Cart</u></center></h4></div>        
  </div>
  <div class="container">
  <div id="mySidenav" class="sidenav">
  <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
  <a href="#"><i>Options</i></a>
  <br><br>
  <a href="ownerpage.html">Refresh Page</a>
  <a href="index.html">Log Out</a>
</div>

    <br>
	<h3><center>Add/Remove Items</center></h3>
  <table id="myTablee" style="width:100% ; background-color: #C0C0C0">
  </table><br>
  <h5><b class="bluetext">Add new item / Change the location of an existing item</b></h5>
  <br>
	<form id="dataform" >
		          <span class="input input--yoshiko">
          <input class="input__field input__field--yoshiko" type="text" id="input-10" required />
          <label class="input__label input__label--yoshiko" for="input-10">
            <span class="input__label-content input__label-content--yoshiko" data-content="Enter Grocery Name">Grocery Name</span>
          </label>
        </span>
    <br>
		              <span class="input input--yoshiko">
          <input class="input__field input__field--yoshiko" type="text" id="input-10" required />
          <label class="input__label input__label--yoshiko" for="input-10">
            <span class="input__label-content input__label-content--yoshiko" data-content="Enter Grocery's X-Coordinate">Grocery's X-Coordinate</span>
          </label>
        </span>
    <br>
		                  <span class="input input--yoshiko">
          <input class="input__field input__field--yoshiko" type="text" id="input-10" required />
          <label class="input__label input__label--yoshiko" for="input-10">
            <span class="input__label-content input__label-content--yoshiko" data-content="Enter Grocery's Y-Coordinate">Grocery's Y-Coordinate</span>
          </label>
        </span>
    <br>
                          <span class="input input--yoshiko">
          <input class="input__field input__field--yoshiko" type="text" id="input-10" required onsubmit="saveData()" />
          <label class="input__label input__label--yoshiko" for="input-10">
            <span class="input__label-content input__label-content--yoshiko" data-content="Enter Grocery's Price per unit">Grocery's Price/Unit</span>
          </label>
        </span>
    <br><br>
		<button onclick="saveData()">Save Data</button>
	</form>
  <br>
  <h5><b class="redtext">Remove an item :</b></h5>
  <br>
  <form id="dataformdel">
                            <span class="input input--yoshiko">
          <input class="input__field input__field--yoshiko" type="text" id="input-10" required />
          <label class="input__label input__label--yoshiko" for="input-10">
            <span class="input__label-content input__label-content--yoshiko" data-content="Enter Grocery Name to be deleted">Grocery to be deleted</span>
          </label>
        </span>
  <br><br>
  <button onclick="delData()">Remove product</button>
  </form>
  <br>
  <span style="font-size:20px;cursor:pointer" onclick="openNav()">&#9776; More Options</span>
  <br><br>
  <!--
  <button id="refButtonn" class="float-left submit-button" >Refresh Page</button>
  &nbsp;
  &nbsp;
  <button id="goback" class="float-left submit-button" >Log out</button>
  <br><br><br>-->
</div>
  <div class="fixed-footer">
<div class="containerr"><h6><center>Copyright &copy; 2018 Smart Shopping Cart</center></h6></div>        
</div>
</div>
</body>
</html>

 <script type="text/javascript">

    var firebdataa = sessionStorage.getItem('fdataa');

      console.log(firebdataa);

      var cllist = new Array();
      var cllist1 = new Array();
      cllist = firebdataa.split('-');

      for(var t=0;t<cllist.length-1;t++)
      {
          cllist1[t] = cllist[t].split(",");
      }

      var table = document.getElementById("myTablee");

      for(var t=-1;t<cllist1.length;t++)
      {

        var row = table.insertRow(t+1);

        if (t===-1)
        {
          var cell1 = row.insertCell(0);
          cell1.innerHTML = "<center>" + "<b>" + "Price per unit" + "</center>" + "</b>";
          cell1.style.backgroundColor = "orange";

          var cell2 = row.insertCell(0);
          cell2.innerHTML = "<center>" + "<b>" + "Y-Coordinate" + "</center>" + "</b>";
          cell2.style.backgroundColor = "orange";

          var cell3 = row.insertCell(0);
          cell3.innerHTML = "<center>" + "<b>"  + "X-Coordinate" + "</center>" + "</b>";
          cell3.style.backgroundColor = "orange";

          var cell4 = row.insertCell(0);
          cell4.innerHTML = "<center>" + "<b>" + "Available Items" + "</center>" + "</b>";
          cell4.style.backgroundColor = "orange";

          continue;
        }

        if (cllist1[t][0]==="undefined")
        {
          continue;
        }
        else
        {
          var cell1 = row.insertCell(0);
          cell1.innerHTML = "<center>" + cllist1[t][3] + "</center>";

          var cell2 = row.insertCell(0);
          cell2.innerHTML = "<center>" + cllist1[t][2] + "</center>";

          var cell3 = row.insertCell(0);
          cell3.innerHTML = "<center>" + cllist1[t][1] + "</center>";

          var cell4 = row.insertCell(0);
          cell4.innerHTML = "<center>" + cllist1[t][0] + "</center>";
        }
      }

    /*document.getElementById("goback").onclick = function () 
    {
    location.href = "index.html";
    };*/

    document.getElementById("refButtonn").onclick = function () {
    location.href = "ownerpage.html";
    };

  	var pdata = "";
  	var proddata = new Array();
  	var fdata = new Array();

  	var compdata;
    var complist = firebase.database().ref();
    complist.on('value', function(namee){
    namee.forEach(function(childSnapshot) {
        var key = childSnapshot.key;
        var childData = childSnapshot.val();
        });
    });

	function saveData() {
    var x = document.getElementById("dataform");
    var i;
    for (i = 0; i < x.length ;i++) {
        pdata += x.elements[i].value + ",";
    }
    proddata = pdata.split(",");
    fdata = proddata.slice(0,4);

    var a = parseInt(fdata[1]);
    var b = parseInt(fdata[2]);
    var c = parseInt(fdata[3]);

    firebase.database().ref(fdata[0]).set({
    name: fdata[0],
    xval: a,
    yval: b,
    price: c
    });

    var datacdn = new Array();
    var complist = firebase.database().ref();
    complist.on('value', function(namee){
    namee.forEach(function(childSnapshot) {
        var cdatan = childSnapshot.val().name;
        var cdatax = childSnapshot.val().xval;
        var cdatay = childSnapshot.val().yval;
        var cdataz = childSnapshot.val().price;
        datacdn = datacdn + cdatan + "," + cdatax + "," + cdatay + ","  + cdataz + "," +  "-";
    });
    sessionStorage.setItem('fdataa',datacdn);
    });
    }  

  function delData() {
    var ddata=new Array();
    var x = document.getElementById("dataformdel");
    var i;
    for (i = 0; i < x.length ;i++) {
        ddata += x.elements[i].value;
    }
    firebase.database().ref().child(ddata).remove();

    var datacdn = new Array();
    var complist = firebase.database().ref();
    complist.on('value', function(namee){
    namee.forEach(function(childSnapshot) {
        var cdatan = childSnapshot.val().name;
        var cdatax = childSnapshot.val().xval;
        var cdatay = childSnapshot.val().yval;
        var cdataz = childSnapshot.val().price;
        datacdn = datacdn + cdatan + "," + cdatax + "," + cdatay + ","  + cdataz + "," +  "-";
    });
    sessionStorage.setItem('fdataa',datacdn);
    });
    } 


  function openNav() {
    document.getElementById("mySidenav").style.width = "180px";
    document.getElementById("main").style.marginLeft = "180px";
    document.body.style.backgroundColor = "rgba(0,0,0,0.4)";
    }

  function closeNav() {
    document.getElementById("mySidenav").style.width = "0";
    document.getElementById("main").style.marginLeft= "0";
    document.body.style.backgroundColor = "white";
  }

</script>
