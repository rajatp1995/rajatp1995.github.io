
<script src="https://www.gstatic.com/firebasejs/4.9.0/firebase.js"></script>
<script src="https://www.gstatic.com/firebasejs/4.9.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/4.9.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/4.9.0/firebase-database.js"></script>

<html>
<head>
  <title>Smart Shopping Cart</title>
  <script type="text/javascript">
  var config = {
    apiKey: "AIzaSyCn_P-dbq07eDimEGzS8qMGObW1JP_U4ts",
    authDomain: "projectdatabase-d5dcc.firebaseapp.com",
    databaseURL: "https://projectdatabase-d5dcc.firebaseio.com",
    projectId: "projectdatabase-d5dcc",
    storageBucket: "projectdatabase-d5dcc.appspot.com",
    messagingSenderId: "289821114496"
  };
    firebase.initializeApp(config);
 </script>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

  <style>
       table, td {
       border: 1px solid black;
       }

       .bluetext {
        color: blue;
       }

       .redtext {
        color: red;
       }

       body {
        height: 200px;
        background: red; 
        background: linear-gradient(rgba(0,0,0,0.4) , rgba(255,0,0,0.4), rgba(0,0,255,0.4)); 
        }
  </style>

</head>
<body>
	<div class="container">
    <br>
	<h3><center>Add/Remove Items</center></h3>
  <table id="myTablee" style="width:100% ; background-color: #C0C0C0">
  </table><br>
  <b class="bluetext">Add a new item / Change the location of an existing item :</b><br>
	<form id="dataform">
		<input type="text" name="pname" placeholder="Product Name" required>
    <br>
		<input type="text" name="px" placeholder="X-Coordinate" required>
    <br>
		<input type="text" name="py" placeholder="Y-Coordinate" required>
    <br>
    <input type="text" name="pz" placeholder="Price per unit" required>
    <br><br>
		<button onclick="saveData()">Save Data</button>
	</form>
  <br><br>
  <b class="redtext">Remove an item :</b><br>
  <form id="dataformdel">
  <input type="text" name="pname" placeholder="Product to be removed" required>
  <br><br>
  <button onclick="delData()">Remove product</button>
  </form>
  <br><br>
  <button id="refButtonn" class="float-left submit-button" >Refresh Page</button>
  &nbsp;
  &nbsp;
  <button id="goback" class="float-left submit-button" >Log out</button>
  <br><br><br>
</div>
</body>
</html>

 <script type="text/javascript">

    var firebdataa = sessionStorage.getItem('fdataa');

      console.log(firebdataa);

      var cllist = new Array();
      var cllist1 = new Array();
      cllist = firebdataa.split('-');

      for(var t=0;t<cllist.length-1;t++)
      {
          cllist1[t] = cllist[t].split(",");
      }

      var table = document.getElementById("myTablee");

      for(var t=-1;t<cllist1.length;t++)
      {

        var row = table.insertRow(t+1);

        if (t===-1)
        {
          var cell1 = row.insertCell(0);
          cell1.innerHTML = "<center>" + "<b>" + "Price per unit" + "</center>" + "</b>";
          cell1.style.backgroundColor = "orange";

          var cell2 = row.insertCell(0);
          cell2.innerHTML = "<center>" + "<b>" + "Y-Coordinate" + "</center>" + "</b>";
          cell2.style.backgroundColor = "orange";

          var cell3 = row.insertCell(0);
          cell3.innerHTML = "<center>" + "<b>"  + "X-Coordinate" + "</center>" + "</b>";
          cell3.style.backgroundColor = "orange";

          var cell4 = row.insertCell(0);
          cell4.innerHTML = "<center>" + "<b>" + "Available Items" + "</center>" + "</b>";
          cell4.style.backgroundColor = "orange";

          continue;
        }

        if (cllist1[t][0]==="undefined")
        {
          continue;
        }
        else
        {
          var cell1 = row.insertCell(0);
          cell1.innerHTML = "<center>" + cllist1[t][3] + "</center>";

          var cell2 = row.insertCell(0);
          cell2.innerHTML = "<center>" + cllist1[t][2] + "</center>";

          var cell3 = row.insertCell(0);
          cell3.innerHTML = "<center>" + cllist1[t][1] + "</center>";

          var cell4 = row.insertCell(0);
          cell4.innerHTML = "<center>" + cllist1[t][0] + "</center>";
        }
      }

    document.getElementById("goback").onclick = function () 
    {
    location.href = "index.html";
    };

    document.getElementById("refButtonn").onclick = function () {
    location.href = "ownerpage.html";
    };

  	var pdata = "";
  	var proddata = new Array();
  	var fdata = new Array();

  	var compdata;
    var complist = firebase.database().ref();
    complist.on('value', function(namee){
    namee.forEach(function(childSnapshot) {
        var key = childSnapshot.key;
        var childData = childSnapshot.val();
        });
    });

	function saveData() {
    var x = document.getElementById("dataform");
    var i;
    for (i = 0; i < x.length ;i++) {
        pdata += x.elements[i].value + ",";
    }
    proddata = pdata.split(",");
    fdata = proddata.slice(0,4);

    var a = parseInt(fdata[1]);
    var b = parseInt(fdata[2]);
    var c = parseInt(fdata[3]);

    firebase.database().ref(fdata[0]).set({
    name: fdata[0],
    xval: a,
    yval: b,
    price: c
    });

    var datacdn = new Array();
    var complist = firebase.database().ref();
    complist.on('value', function(namee){
    namee.forEach(function(childSnapshot) {
        var cdatan = childSnapshot.val().name;
        var cdatax = childSnapshot.val().xval;
        var cdatay = childSnapshot.val().yval;
        var cdataz = childSnapshot.val().price;
        datacdn = datacdn + cdatan + "," + cdatax + "," + cdatay + ","  + cdataz + "," +  "-";
    });
    sessionStorage.setItem('fdataa',datacdn);
    });
    }  

  function delData() {
    var ddata=new Array();
    var x = document.getElementById("dataformdel");
    var i;
    for (i = 0; i < x.length ;i++) {
        ddata += x.elements[i].value;
    }
    firebase.database().ref().child(ddata).remove();

    var datacdn = new Array();
    var complist = firebase.database().ref();
    complist.on('value', function(namee){
    namee.forEach(function(childSnapshot) {
        var cdatan = childSnapshot.val().name;
        var cdatax = childSnapshot.val().xval;
        var cdatay = childSnapshot.val().yval;
        var cdataz = childSnapshot.val().price;
        datacdn = datacdn + cdatan + "," + cdatax + "," + cdatay + ","  + cdataz + "," +  "-";
    });
    sessionStorage.setItem('fdataa',datacdn);
    });
    } 

</script>